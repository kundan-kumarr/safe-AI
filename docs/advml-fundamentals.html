<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Deep Learning Models Overview – Safe AI for Cyber-Physical &amp; Intelligent Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./whitebox-attacks.html" rel="next">
<link href="./deep-learning.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advml-fundamentals.html">Part II — Adversarial Machine Learning</a></li><li class="breadcrumb-item"><a href="./advml-fundamentals.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Safe AI for Cyber-Physical &amp; Intelligent Systems</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/kundan-kumarr/StatSphere/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Safe-AI-for-Cyber-Physical---Intelligent-Systems.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Safe-AI-for-Cyber-Physical---Intelligent-Systems.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I — Foundations of Safe Intelligent Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-ai-security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml-for-cps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II — Adversarial Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advml-fundamentals.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whitebox-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Adversarial Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blackbox-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-poisoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./defenses-advml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Poisoning Attacks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III — Attacks on Large Language Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prompt-injection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prompt-extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adversarial Machine Learning in Malware</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Adversarial LLMs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./memory-poisoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Adversarial LLMs1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rag-poisoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jailbreak-automation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV — Defenses for Large Language Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./defensive-prompts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool-gating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rag-security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monitoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./governance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V — Safe AI for Cyber-Physical Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./safe-rl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cps-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cps-defenses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI — Methods for Research, Evaluation &amp; Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research-directions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Adversarial LLMs1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./writing-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VII — Alignment &amp; Safe Autonomous Agents</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alignment-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goal-misgeneralization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deceptive-alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rlhf-constitutional-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./safe-agent-architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alignment-for-cps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./open-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-prompt-engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Weighted least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-eval-checklists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Generalized least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-security-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Synchrony of parametric trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-datasets-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Analysis of precipitation extremes and climate projections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-tools-libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Practice exercises</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#machine-learning-basics" id="toc-machine-learning-basics" class="nav-link active" data-scroll-target="#machine-learning-basics"><span class="header-section-number">4.1</span> Machine Learning Basics</a></li>
  <li>
<a href="#types-of-machine-learning" id="toc-types-of-machine-learning" class="nav-link" data-scroll-target="#types-of-machine-learning"><span class="header-section-number">4.2</span> Types of Machine Learning</a>
  <ul class="collapse">
<li><a href="#supervised-learning" id="toc-supervised-learning" class="nav-link" data-scroll-target="#supervised-learning"><span class="header-section-number">4.2.1</span> Supervised Learning</a></li>
  <li><a href="#unsupervised-learning" id="toc-unsupervised-learning" class="nav-link" data-scroll-target="#unsupervised-learning"><span class="header-section-number">4.2.2</span> Unsupervised Learning</a></li>
  <li><a href="#reinforcement-learning" id="toc-reinforcement-learning" class="nav-link" data-scroll-target="#reinforcement-learning"><span class="header-section-number">4.2.3</span> Reinforcement Learning</a></li>
  </ul>
</li>
  <li><a href="#linear-vs-nonlinear-models" id="toc-linear-vs-nonlinear-models" class="nav-link" data-scroll-target="#linear-vs-nonlinear-models"><span class="header-section-number">4.3</span> 3. Linear vs Nonlinear Models</a></li>
  <li><a href="#structure-of-neural-networks" id="toc-structure-of-neural-networks" class="nav-link" data-scroll-target="#structure-of-neural-networks"><span class="header-section-number">4.4</span> Structure of Neural Networks</a></li>
  <li><a href="#activation-functions" id="toc-activation-functions" class="nav-link" data-scroll-target="#activation-functions"><span class="header-section-number">4.5</span> Activation Functions</a></li>
  <li><a href="#loss-functions" id="toc-loss-functions" class="nav-link" data-scroll-target="#loss-functions"><span class="header-section-number">4.6</span> Loss Functions</a></li>
  <li>
<a href="#gradient-descent" id="toc-gradient-descent" class="nav-link" data-scroll-target="#gradient-descent"><span class="header-section-number">4.7</span> Gradient Descent</a>
  <ul class="collapse">
<li><a href="#mini-batch-gradient-descent" id="toc-mini-batch-gradient-descent" class="nav-link" data-scroll-target="#mini-batch-gradient-descent"><span class="header-section-number">4.7.1</span> Mini-batch Gradient Descent</a></li>
  </ul>
</li>
  <li><a href="#momentum-and-learning-rate-schedules" id="toc-momentum-and-learning-rate-schedules" class="nav-link" data-scroll-target="#momentum-and-learning-rate-schedules"><span class="header-section-number">4.8</span> Momentum and Learning Rate Schedules</a></li>
  <li><a href="#vanishing-and-exploding-gradients" id="toc-vanishing-and-exploding-gradients" class="nav-link" data-scroll-target="#vanishing-and-exploding-gradients"><span class="header-section-number">4.9</span> Vanishing and Exploding Gradients</a></li>
  <li>
<a href="#regularization-for-generalization" id="toc-regularization-for-generalization" class="nav-link" data-scroll-target="#regularization-for-generalization"><span class="header-section-number">4.10</span> Regularization for Generalization</a>
  <ul class="collapse">
<li><a href="#weight-decay" id="toc-weight-decay" class="nav-link" data-scroll-target="#weight-decay"><span class="header-section-number">4.10.1</span> Weight Decay</a></li>
  <li><a href="#dropout" id="toc-dropout" class="nav-link" data-scroll-target="#dropout"><span class="header-section-number">4.10.2</span> Dropout</a></li>
  <li><a href="#early-stopping" id="toc-early-stopping" class="nav-link" data-scroll-target="#early-stopping"><span class="header-section-number">4.10.3</span> Early Stopping</a></li>
  <li><a href="#batch-normalization" id="toc-batch-normalization" class="nav-link" data-scroll-target="#batch-normalization"><span class="header-section-number">4.10.4</span> Batch Normalization</a></li>
  </ul>
</li>
  <li><a href="#convolutional-neural-networks-cnns" id="toc-convolutional-neural-networks-cnns" class="nav-link" data-scroll-target="#convolutional-neural-networks-cnns"><span class="header-section-number">4.11</span> Convolutional Neural Networks (CNNs)</a></li>
  <li><a href="#residual-networks-resnets" id="toc-residual-networks-resnets" class="nav-link" data-scroll-target="#residual-networks-resnets"><span class="header-section-number">4.12</span> Residual Networks (ResNets)</a></li>
  <li>
<a href="#recurrent-neural-networks-rnns" id="toc-recurrent-neural-networks-rnns" class="nav-link" data-scroll-target="#recurrent-neural-networks-rnns"><span class="header-section-number">4.13</span> Recurrent Neural Networks (RNNs)</a>
  <ul class="collapse">
<li><a href="#long-short-term-memory-lstm" id="toc-long-short-term-memory-lstm" class="nav-link" data-scroll-target="#long-short-term-memory-lstm"><span class="header-section-number">4.13.1</span> Long Short-Term Memory (LSTM)</a></li>
  </ul>
</li>
  <li><a href="#transformer-networks" id="toc-transformer-networks" class="nav-link" data-scroll-target="#transformer-networks"><span class="header-section-number">4.14</span> Transformer Networks</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.15</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/kundan-kumarr/StatSphere/edit/master/advml-fundamentals.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kundan-kumarr/StatSphere/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advml-fundamentals.html">Part II — Adversarial Machine Learning</a></li><li class="breadcrumb-item"><a href="./advml-fundamentals.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>The goal of this lecture is to understand the core principles and architectures of deep learning models. We will learn how deep learning extends traditional machine learning through multi-layer neural networks, explore the mathematical foundation behind neural computations, and understand how training and optimization methods such as gradient descent enable models to learn complex patterns from data.</p>
<p><strong>Objectives</strong></p>
<ol type="1">
<li>Describe how Deep Learning (DL) fits within the broader field of Machine Learning (ML) and Artificial Intelligence (AI).</li>
<li>Explain the structure and mathematical operations of a neural network, including layers, weights, biases, and activations.</li>
<li>Distinguish between linear and non-linear models, and understand how non-linearity enables complex decision boundaries.</li>
<li>Apply concepts of activation functions such as sigmoid, tanh, and ReLU, and interpret their mathematical properties.</li>
<li>Understand the training process of deep neural networks using gradient descent and backpropagation.</li>
<li>Discuss common problems such as overfitting, vanishing gradients, and how regularization and normalization techniques mitigate them.</li>
<li>Identify the structure and purpose of key architectures including Convolutional Neural Networks (CNNs), Recurrent Neural Networks (RNNs), and Transformers.</li>
</ol>
<p><strong>Reading materials</strong></p>
<ul>
<li>CS231n: Convolutional Neural Networks for Visual Recognition – Stanford University</li>
<li>Goodfellow, Bengio &amp; Courville (2016) – Deep Learning, MIT Press, Chapters 6–8</li>
<li>Hung-Yi Lee – Deep Learning Tutorial</li>
<li>Ismini Lourentzou – Introduction to Deep Learning</li>
<li>Sebastian Ruder (2016) – An Overview of Gradient Descent Optimization Algorithms</li>
</ul>
<section id="machine-learning-basics" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="machine-learning-basics">
<span class="header-section-number">4.1</span> Machine Learning Basics</h2>
<p>Machine learning enables computers to learn patterns from data without explicit programming. The goal of an ML model is to find a mapping function:</p>
<p>Machine learning aims to learn a function <span class="math inline">\(f_\theta\)</span> that maps inputs <span class="math inline">\(x\)</span> to outputs <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[
f_\theta : X \rightarrow Y,
\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> represents model parameters (weights and biases).<br>
The learning objective is to minimize the expected loss:</p>
<p><span class="math display">\[
\theta^* = \arg\min_\theta \, \mathbb{E}_{(x, y) \sim D}[L(y, f_\theta(x))].
\]</span></p>
</section><section id="types-of-machine-learning" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="types-of-machine-learning">
<span class="header-section-number">4.2</span> Types of Machine Learning</h2>
<section id="supervised-learning" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="supervised-learning">
<span class="header-section-number">4.2.1</span> Supervised Learning</h3>
<p>Learns from labeled pairs <span class="math inline">\((x_i, y_i)\)</span> to predict <span class="math inline">\(\hat{y_i}\)</span>.</p>
<ul>
<li>
<strong>Regression:</strong> <span class="math inline">\(y_i = f_\theta(x_i) + \varepsilon_i\)</span>
</li>
<li>
<strong>Classification:</strong> <span class="math inline">\(P(y=1|x) = \frac{1}{1 + e^{-(\beta_0 + \beta_1x)}}\)</span>
</li>
</ul></section><section id="unsupervised-learning" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="unsupervised-learning">
<span class="header-section-number">4.2.2</span> Unsupervised Learning</h3>
<p>Finds structure in unlabeled data <span class="math inline">\(\{x_i\}\)</span>.</p>
<ul>
<li>
<strong>Clustering:</strong> <span class="math display">\[
\min_{\{C_k\}} \sum_{k=1}^K \sum_{x_i \in C_k} \|x_i - \mu_k\|^2
\]</span>
</li>
<li>
<strong>PCA:</strong> <span class="math display">\[
W^* = \arg\max_W \det(W^\top S W)
\]</span>
</li>
</ul></section><section id="reinforcement-learning" class="level3" data-number="4.2.3"><h3 data-number="4.2.3" class="anchored" data-anchor-id="reinforcement-learning">
<span class="header-section-number">4.2.3</span> Reinforcement Learning</h3>
<p>Learns a policy <span class="math inline">\(\pi(a|s)\)</span> that maximizes reward:</p>
<p><span class="math display">\[
J(\pi) = \mathbb{E}\left[\sum_{t=0}^{T}\gamma^t r_t\right].
\]</span></p>
</section></section><section id="linear-vs-nonlinear-models" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="linear-vs-nonlinear-models">
<span class="header-section-number">4.3</span> 3. Linear vs Nonlinear Models</h2>
<p>A <strong>linear classifier</strong> defines a boundary:</p>
<p><span class="math display">\[
\mathbf{w}^\top \mathbf{x} + b = 0.
\]</span></p>
<p>A <strong>nonlinear classifier</strong> maps data to a transformed space <span class="math inline">\(\phi(x)\)</span>:</p>
<p><span class="math display">\[
f(x) = \mathbf{w}^\top \phi(x) + b.
\]</span></p>
<p>Neural networks learn these nonlinear transformations automatically through layers of activations. <img src="figures/linear_vs_nonlinear.png" class="img-fluid" style="width:80.0%" data-fig-cap="Linear vs Nonlinear Classification.   Linear classifiers separate data using a single hyperplane, while nonlinear classifiers create curved or complex boundaries through kernel transformations or hidden layers in neural networks."></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> np.random.randn(<span class="dv">40</span>, <span class="dv">2</span>) <span class="op">+</span> np.array([<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> np.random.randn(<span class="dv">40</span>, <span class="dv">2</span>) <span class="op">+</span> np.array([<span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot points</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(X1[:, <span class="dv">0</span>], X1[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">"dodgerblue"</span>, label<span class="op">=</span><span class="st">"Class A"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.scatter(X2[:, <span class="dv">0</span>], X2[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">"orange"</span>, label<span class="op">=</span><span class="st">"Class B"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear boundary</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">100</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> x_vals, <span class="st">'b--'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Linear Boundary"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Nonlinear boundary (quadratic)</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, <span class="fl">0.2</span> <span class="op">*</span> x_vals<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>, <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Nonlinear Boundary"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Linear vs Nonlinear Classification"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"$x_1$"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"$x_2$"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="advml-fundamentals_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="structure-of-neural-networks" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="structure-of-neural-networks">
<span class="header-section-number">4.4</span> Structure of Neural Networks</h2>
<p>Each neuron performs a linear combination followed by a nonlinear transformation:</p>
<p><span class="math display">\[
z = \mathbf{w}^\top \mathbf{x} + b, \quad a = \sigma(z)
\]</span></p>
<p>For a deep network with <span class="math inline">\(L\)</span> layers:</p>
<p><span class="math display">\[
\begin{aligned}
a^{(1)} &amp;= \sigma(W^{(1)}x + b^{(1)}) \\
a^{(2)} &amp;= \sigma(W^{(2)}a^{(1)} + b^{(2)}) \\
&amp;\vdots \\
\hat{y} &amp;= \sigma(W^{(L)}a^{(L-1)} + b^{(L)})
\end{aligned}
\]</span></p>
</section><section id="activation-functions" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="activation-functions">
<span class="header-section-number">4.5</span> Activation Functions</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 27%">
<col style="width: 22%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Formula</th>
<th>Range</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Sigmoid</strong></td>
<td><span class="math inline">\(\sigma(x) = \frac{1}{1 + e^{-x}}\)</span></td>
<td>(0, 1)</td>
<td>Saturates, causes vanishing gradients</td>
</tr>
<tr class="even">
<td><strong>Tanh</strong></td>
<td><span class="math inline">\(\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}\)</span></td>
<td>(-1, 1)</td>
<td>Zero-centered</td>
</tr>
<tr class="odd">
<td><strong>ReLU</strong></td>
<td><span class="math inline">\(\text{ReLU}(x) = \max(0, x)\)</span></td>
<td>[0, ∞)</td>
<td>Fast and sparse</td>
</tr>
<tr class="even">
<td><strong>Leaky ReLU</strong></td>
<td><span class="math inline">\(\text{LeakyReLU}(x) = \max(\alpha x, x)\)</span></td>
<td>(-∞, ∞)</td>
<td>Fixes “dying ReLU”</td>
</tr>
<tr class="odd">
<td><strong>Linear</strong></td>
<td><span class="math inline">\(f(x) = cx\)</span></td>
<td>(-∞, ∞)</td>
<td>Used in regression</td>
</tr>
</tbody>
</table></section><section id="loss-functions" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="loss-functions">
<span class="header-section-number">4.6</span> Loss Functions</h2>
<p>To train a network, we minimize a loss function <span class="math inline">\(L(y, \hat{y})\)</span>:</p>
<ul>
<li>
<strong>Mean Squared Error (MSE):</strong> <span class="math display">\[
L = \frac{1}{N}\sum_{i=1}^{N}(y_i - \hat{y}_i)^2
\]</span>
</li>
<li>
<strong>Cross-Entropy Loss:</strong> <span class="math display">\[
L = -\sum_i y_i \log(\hat{y}_i)
\]</span>
</li>
</ul></section><section id="gradient-descent" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="gradient-descent">
<span class="header-section-number">4.7</span> Gradient Descent</h2>
<p>Model parameters are updated iteratively:</p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \eta \nabla_\theta L(\theta_t),
\]</span></p>
<p>where <span class="math inline">\(\eta\)</span> is the <strong>learning rate</strong>.</p>
<section id="mini-batch-gradient-descent" class="level3" data-number="4.7.1"><h3 data-number="4.7.1" class="anchored" data-anchor-id="mini-batch-gradient-descent">
<span class="header-section-number">4.7.1</span> Mini-batch Gradient Descent</h3>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \frac{\eta}{m} \sum_{i=1}^{m}\nabla_\theta L_i(\theta_t)
\]</span></p>
<p>Balances speed and stability in updates.</p>
</section></section><section id="momentum-and-learning-rate-schedules" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="momentum-and-learning-rate-schedules">
<span class="header-section-number">4.8</span> Momentum and Learning Rate Schedules</h2>
<p>Add momentum to accelerate convergence:</p>
<p><span class="math display">\[
v_t = \beta v_{t-1} + (1 - \beta)\nabla_\theta L(\theta_t),
\quad \theta_{t+1} = \theta_t - \eta v_t
\]</span></p>
<p><strong>Learning rate schedules:</strong></p>
<ul>
<li>Step decay: <span class="math inline">\(\eta_t = \eta_0 \gamma^{\lfloor t/s \rfloor}\)</span>
</li>
<li>Exponential decay: <span class="math inline">\(\eta_t = \eta_0 e^{-\lambda t}\)</span>
</li>
<li>Cosine annealing: <span class="math inline">\(\eta_t = \eta_0 \frac{1}{2}(1 + \cos(\pi t/T))\)</span>
</li>
</ul></section><section id="vanishing-and-exploding-gradients" class="level2" data-number="4.9"><h2 data-number="4.9" class="anchored" data-anchor-id="vanishing-and-exploding-gradients">
<span class="header-section-number">4.9</span> Vanishing and Exploding Gradients</h2>
<p>Gradients may vanish or explode when propagated through many layers:</p>
<p><span class="math display">\[
\frac{\partial L}{\partial W^{(l)}} \propto \prod_{i&gt;l} \frac{\partial a^{(i)}}{\partial z^{(i)}}
\]</span></p>
<p><strong>Solutions:</strong> - ReLU activations - Batch normalization - Gradient clipping - LSTM gates in RNNs</p>
</section><section id="regularization-for-generalization" class="level2" data-number="4.10"><h2 data-number="4.10" class="anchored" data-anchor-id="regularization-for-generalization">
<span class="header-section-number">4.10</span> Regularization for Generalization</h2>
<section id="weight-decay" class="level3" data-number="4.10.1"><h3 data-number="4.10.1" class="anchored" data-anchor-id="weight-decay">
<span class="header-section-number">4.10.1</span> Weight Decay</h3>
<p><span class="math display">\[
L' = L + \lambda \|W\|_2^2
\]</span></p>
</section><section id="dropout" class="level3" data-number="4.10.2"><h3 data-number="4.10.2" class="anchored" data-anchor-id="dropout">
<span class="header-section-number">4.10.2</span> Dropout</h3>
<p><span class="math display">\[
a_i' = a_i \cdot r_i, \quad r_i \sim \text{Bernoulli}(1 - p)
\]</span></p>
</section><section id="early-stopping" class="level3" data-number="4.10.3"><h3 data-number="4.10.3" class="anchored" data-anchor-id="early-stopping">
<span class="header-section-number">4.10.3</span> Early Stopping</h3>
<p>Stop when validation loss no longer improves.</p>
</section><section id="batch-normalization" class="level3" data-number="4.10.4"><h3 data-number="4.10.4" class="anchored" data-anchor-id="batch-normalization">
<span class="header-section-number">4.10.4</span> Batch Normalization</h3>
<p><span class="math display">\[
\hat{x} = \frac{x - \mu_B}{\sqrt{\sigma_B^2 + \epsilon}}, \quad y = \gamma \hat{x} + \beta
\]</span></p>
</section></section><section id="convolutional-neural-networks-cnns" class="level2" data-number="4.11"><h2 data-number="4.11" class="anchored" data-anchor-id="convolutional-neural-networks-cnns">
<span class="header-section-number">4.11</span> Convolutional Neural Networks (CNNs)</h2>
<p>Convolution extracts local spatial features:</p>
<p><span class="math display">\[
Y(i, j) = \sum_m \sum_n X(i + m, j + n) K(m, n)
\]</span></p>
<p>Pooling reduces spatial dimension:</p>
<ul>
<li>Max Pooling: <span class="math inline">\(y = \max(x_1, \dots, x_n)\)</span><br>
</li>
<li>Average Pooling: <span class="math inline">\(y = \frac{1}{n}\sum_i x_i\)</span>
</li>
</ul></section><section id="residual-networks-resnets" class="level2" data-number="4.12"><h2 data-number="4.12" class="anchored" data-anchor-id="residual-networks-resnets">
<span class="header-section-number">4.12</span> Residual Networks (ResNets)</h2>
<p>Residual connections help train very deep networks:</p>
<p><span class="math display">\[
y = F(x) + x
\]</span></p>
<p>The network learns the residual mapping <span class="math inline">\(F(x) = H(x) - x\)</span>, stabilizing gradients across hundreds of layers.</p>
</section><section id="recurrent-neural-networks-rnns" class="level2" data-number="4.13"><h2 data-number="4.13" class="anchored" data-anchor-id="recurrent-neural-networks-rnns">
<span class="header-section-number">4.13</span> Recurrent Neural Networks (RNNs)</h2>
<p>Sequential models update a hidden state over time:</p>
<p><span class="math display">\[
h_t = f(W_h h_{t-1} + W_x x_t + b)
\]</span></p>
<section id="long-short-term-memory-lstm" class="level3" data-number="4.13.1"><h3 data-number="4.13.1" class="anchored" data-anchor-id="long-short-term-memory-lstm">
<span class="header-section-number">4.13.1</span> Long Short-Term Memory (LSTM)</h3>
<p><span class="math display">\[
\begin{aligned}
i_t &amp;= \sigma(W_i x_t + U_i h_{t-1} + b_i) \\
f_t &amp;= \sigma(W_f x_t + U_f h_{t-1} + b_f) \\
o_t &amp;= \sigma(W_o x_t + U_o h_{t-1} + b_o) \\
c_t &amp;= f_t \odot c_{t-1} + i_t \odot \tanh(W_c x_t + U_c h_{t-1} + b_c) \\
h_t &amp;= o_t \odot \tanh(c_t)
\end{aligned}
\]</span></p>
</section></section><section id="transformer-networks" class="level2" data-number="4.14"><h2 data-number="4.14" class="anchored" data-anchor-id="transformer-networks">
<span class="header-section-number">4.14</span> Transformer Networks</h2>
<p>Self-attention replaces recurrence, allowing parallel computation.</p>
<p><span class="math display">\[
\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^\top}{\sqrt{d_k}}\right)V
\]</span></p>
<p>Multiple heads attend to different relationships:</p>
<p><span class="math display">\[
\text{MultiHead}(Q, K, V) = \text{Concat}(head_1, \ldots, head_h) W^O
\]</span></p>
<p>Transformers power modern large language models such as GPT and BERT.</p>
</section><section id="summary" class="level2" data-number="4.15"><h2 data-number="4.15" class="anchored" data-anchor-id="summary">
<span class="header-section-number">4.15</span> Summary</h2>
<p>Deep learning combines principles of <strong>linear algebra, calculus, and probability</strong> to learn from massive datasets.</p>
<p><span class="math display">\[
\text{Forward Pass: } y = f_\theta(x), \quad
\text{Backward Pass: } \theta \leftarrow \theta - \eta \nabla_\theta L
\]</span></p>
<p>From perceptrons to transformers, every model refines this foundation — learning richer representations through mathematics and computation.</p>
<!--
We have already discussed the class of ARMA models for representing stationary series. 
A generalization of this class, which incorporates a wide range of nonstationary series, is provided by the *autoregressive integrated moving average* (ARIMA) processes, i.e., processes which, after differencing finitely many times, reduce to ARMA processes.

If $d$ is a nonnegative integer, then $X_t$ is an ARIMA($p, d, q$) process if $Y_t=(1 - B)^d X_t$ is a causal ARMA($p, q$) process. 
The process is stationary if $d = 0$, in which case it reduces to an ARMA($p, q$) process.

For example $X_t$ is an ARIMA(1,1,0) process, then $Y_t$ representing the series of its first-order differences (because $d = 1$) is an ARMA(1,0) process
$$
Y_t = (1 - B)X_t = \phi_1 Y_{t-1} + Z_t,
$$
where $|\phi_1| < 1$ and $Z_t$ is white noise.

An equation for ARIMA($p, d, q$) is
$$
(1 - B)^d (1 - \phi_1B - \dots - \phi_pB^p)X_t = 
(1 + \theta_1B + \dots + \theta_qB^q)Z_t,
$$ {#eq-arima}
where $B$ is the backshift operator, $d$ is the order of differences, $\phi_1, \dots, \phi_p$ are autoregression coefficients, $p$ is the autoregressive order, $\theta_1, \dots, \theta_q$ are moving average coefficients, $q$ is the moving average order, and $Z_t\sim \mathrm{WN}(0,\sigma^2)$. 
The left part of @eq-arima consists of the differences and the AR part; the right part represents the MA part.

::: {.callout-note}
Modifications of @eq-arima exists, such as those having both the AR and MA parts on the right side. 
This affects the signs of estimated coefficients $\phi_1, \dots, \phi_p$ and possibly $\theta_1, \dots, \theta_q$. 
Check the help files of the software to know the exact form of the model it is estimating.
:::

**Why the process is called 'integrated'?**

Recall the geometric interpretation of the integral of a curve $y = f(x)$ defined on continuous $x$. 
The integral of $y$ corresponds to the area under the curve. 
For example, if $y = f(x)$ is a function describing income $y$ based on working time $x$, the integral corresponds to the total income in a certain period.

In our lectures, we deal with time series defined using discrete times $t$ (for example, years), so yearly income is $Y_t$, and the total income over several years can be obtained by summing the individual annual incomes, $\sum Y_t$. 
Hence, here we integrate by summation.

Recall the definition of random walk series, which is a cumulative sum of i.i.d. noise:
$$
X_t = \sum_{i=1}^t Y_i,
$$
where $Y_t \sim$ i.i.d.($0,\sigma^2$).
This $X_t$ is the simplest example of integrated series. 
The notation $X_t \sim$ I(1) means $X_t$ is a first-order integrated series. 
The differences of $X_t$
$$
\begin{align}
(1 - B)X_t &= X_t - BX_t \\
&= X_t - X_{t-1} \\
&= Y_t
\end{align}
$$
give us back the uncorrelated series $Y_t$, hence the process $X_t$ is an ARIMA(0,1,0) process.

::: {.callout-note}
ARIMA($p, d, q$) processes with $d \geqslant 1$ are also called *difference-stationary* processes or processes with a *stochastic trend*.
I.e., difference-stationary means the process is not stationary but can be made stationary by proper differencing.
:::


## Box--Jenkins methodology

The approach developed by @Box:Jenkins:1976 applies the differencing to the original time series repeatedly, until a stationary time series is obtained. 
We will first learn how to identify the number of differences (i.e., the order of differences $d$) by analyzing plots of the time series and ACF at each iteration of the method. 
In the later lecture on detecting trends in time series, we will also introduce formal tests for the integration order.

Below is a general algorithm used to fit ARIMA($p, d, q$) models

1. Start assuming $d = 0$.
1. Plot the time series and ACF.
1. If the plots suggest nonstationarity, iterate differencing and plotting to update $d$:
    * Apply differences of the current time series, write $d = d + 1$
    * Plot the time series and ACF
    * If nonstationarity is still obvious, repeat the differencing and plotting
1. Identify the orders $p$ and $q$ from the plots of ACF and PACF of the latest (differenced) time series.
1. Estimate the model.
1. Apply model diagnostics, particularly for homogeneity, uncorrelatedness, and normality of residuals. 
Address the violations by respecifying the model.
1. Forecast with the resultant model.

Using the Box--Jenkins methodology, the linear predictor approximately follows a normal distribution, i.e.,
$$
\hat{X}_{n+h} \sim N\left( X_{n+h}, \mathrm{var}(\hat{X}_{n+h}) \right).
$$

Therefore, a $(100 - \alpha)$\% prediction interval is
$$
\hat{X}_{n+h} \pm z_{1-\alpha/2} \sqrt{\mathrm{var}(\hat{X}_{n+h})}.
$$

::: {.callout-note icon=false}

## Example: ARIMA for Lake Baikal

Here we find an ARIMA model for the Lake Baikal thaw (breakup) dates from the Global Lake and River Ice Phenology Database [@Benson:etal:2020].


::: {.cell}

```{.r .cell-code}
# Calculate calendar day from ice break-up date
B <- read.csv("data/baikal.csv", skip = 1) %>%
    mutate(Date_iceoff = as.Date(paste(iceoff_year, iceoff_month, iceoff_day,
                                       sep = "-"))) %>%
    mutate(DoY_iceoff = as.numeric(format(Date_iceoff, "%j")))

# Convert to ts format
iceoff <- ts(B$DoY_iceoff, start = B$iceoff_year[1])
```
:::


@fig-BaikalARIMA shows that there is possibly a decreasing trend (ice melts earlier in the year), although the ACF declines fast.


::: {.cell}

```{.r .cell-code}
X <- iceoff
p1 <- forecast::autoplot(X) +
    xlab("Year") +
    ylab("Ice breakup day")
p2 <- forecast::ggAcf(X) +
    ggtitle("")
p3 <- forecast::ggAcf(X, type = "partial") +
    ggtitle("")
p1 / (p2 + p3) +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Plots for the original time series of ice breakup days.](advml-fundamentals_files/figure-html/fig-BaikalARIMA-1.png){#fig-BaikalARIMA width=768}
:::
:::


To remove this potential trend, we apply differencing once (more specifically, consecutive differencing, $X_t - X_{t-1}$) and produce the plots again. 
From @fig-BaikalARIMAd1, there is no tendency in the differenced series, and the ACF declines fast, so we achieved stationarity and no need to difference the data more. 
Overall, we differenced the time series once to achieve stationarity, so the order of differences $d = 1$.


::: {.cell}

```{.r .cell-code}
X <- diff(iceoff)
p1 <- ggplot2::autoplot(X) +
    xlab("Year") +
    ylab("diff(Ice breakup day)")
p2 <- forecast::ggAcf(X) +
    ggtitle("")
p3 <- forecast::ggAcf(X, type = "partial") +
    ggtitle("")
p1 / (p2 + p3) +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Plots for the differenced time series of ice breakup days.](advml-fundamentals_files/figure-html/fig-BaikalARIMAd1-1.png){#fig-BaikalARIMAd1 width=768}
:::
:::


Continue working with @fig-BaikalARIMAd1 to identify the orders $p$ and $q$. 
If we treat the behavior of ACF as exhibiting a cut-off, and PACF having an exponential decay, an MA($q$) model might be plausible (i.e., $p = 0$). 
Since the ACF cuts off after lag 1, $q = 1$ in this case. 

Hence, we specified the model for ice breakup dates to be ARIMA(0,1,1), which can be written as 
$$
(1 - B) Y_t = (1 + \theta_1B)Z_t
$$
or
$$
Y_t = Y_{t-1} + \theta_1 Z_{t-1} + Z_t,
$$
where $Y_t$ represents the ice breakup dates in the year $t$, $\theta_1$ is the moving average coefficient, and $Z_t\sim \mathrm{WN}(0,\sigma^2)$.

We can now estimate the model, for example, using `stats::arima()`.


::: {.cell}

```{.r .cell-code  code-fold="false"}
mod_baikal <- stats::arima(iceoff, order = c(0, 1, 1))
mod_baikal
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> stats::arima(x = iceoff, order = c(0, 1, 1))
#> 
#> Coefficients:
#>          ma1
#>       -0.843
#> s.e.   0.075
#> 
#> sigma^2 estimated as 59:  log likelihood = -519,  aic = 1042
```


:::
:::


We can also check the orders selected automatically: 


::: {.cell}

```{.r .cell-code  code-fold="false"}
forecast::auto.arima(iceoff)
```

::: {.cell-output .cell-output-stdout}

```
#> Series: iceoff 
#> ARIMA(0,1,1) 
#> 
#> Coefficients:
#>          ma1
#>       -0.843
#> s.e.   0.075
#> 
#> sigma^2 = 59.4:  log likelihood = -519
#> AIC=1042   AICc=1043   BIC=1048
```


:::
:::


In the next step, we apply diagnostic checks for the residuals, for example, using plots (@fig-BaikalARIMAres). 
Remember that the residuals should resemble white noise.


::: {.cell}

```{.r .cell-code}
e <- mod_baikal$residuals
p1 <- ggplot2::autoplot(e) + 
    ylab("Residuals")
p2 <- forecast::ggAcf(e) +
    ggtitle("")
p3 <- ggpubr::ggqqplot(e) + 
    xlab("Standard normal quantiles")
p1 / (p2 + p3) +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Residual diagnostics for the ARIMA(0,1,1) model for ice breakup dates.](advml-fundamentals_files/figure-html/fig-BaikalARIMAres-1.png){#fig-BaikalARIMAres width=768}
:::
:::


Given that the diagnostics plots show satisfactory behavior of the residuals (@fig-BaikalARIMAres), continue with forecasting using this model (@fig-BaikalARIMAfcst). 
Note that ARIMA(0,1,1) is mathematically equivalent to simple exponential smoothing, hence the forecast is a horizontal line.


::: {.cell}

```{.r .cell-code}
ggplot2::autoplot(forecast::forecast(mod_baikal, h = 10)) + 
    xlab("Year") +
    ylab("Ice breakup day") +
    ggtitle("")
```

::: {.cell-output-display}
![ARIMA(0,1,1) model predictions of ice breakup dates 10 years ahead.](advml-fundamentals_files/figure-html/fig-BaikalARIMAfcst-1.png){#fig-BaikalARIMAfcst width=768}
:::
:::

:::


## Seasonal ARIMA (SARIMA)

Recall that time series with seasonal variability or another strictly periodic component (e.g., daily cycles) can be deseasonalized by applying differencing that is not of consecutive values but with a lag equal to the period of the cyclical variability. 
We will use such differences to remove *strong* periodicity, as an additional step in the Box--Jenkins algorithm.

Similar to the regular differences, we will apply seasonal differences not to eliminate autocorrelations at the corresponding lags, but to achieve fast decay of ACF at seasonal lags. 
Even after the seasonal differences, there might be significant spikes at the seasonal lags in ACF and PACF, which can be addressed by selecting proper seasonal autoregressive and moving average orders. 
Therefore, we can define orders of integration, AR, and MA for the seasonal part of the time series in the same way we define these orders for the non-seasonal part.

Based on the definitions in @Brockwell:Davis:2002, $X_t$ is a *seasonal autoregressive integrated moving average*, SARIMA($p,d,q$)($P,D,Q$)$_s$ process if the differenced series $Y_t=(1 - B)^d (1 - B^s)^D X_t$ is a causal ARMA process. 
Here $d$ and $D$ are nonnegative integers, and $s$ is the period.

::: {.callout-note}
In practice, $D \leqslant 1$ and $P, Q \leqslant 3$.
:::

An equation for SARIMA($p, d, q$)($P, D, Q$)$_s$ is
$$
\begin{split}
(1 - B)^d (1 - \phi_1B - \dots - \phi_pB^p) (1 - B^s)^D (1 - \Phi_1B^s - \dots - \Phi_PB^{sP}) X_t \\
= (1 + \theta_1B + \dots + \theta_qB^q) (1 + \Theta_1B^s + \dots + \Theta_QB^{sQ})Z_t,
\end{split}
$$ {#eq-sarima}
where $D$ is the order of seasonal differences, $\Phi_1, \dots, \Phi_P$ are the seasonal autoregression coefficients, $P$ is the seasonal autoregressive order, $\Theta_1, \dots, \Theta_q$ are seasonal moving average coefficients, $Q$ is the seasonal moving average order, and the rest of the terms are the same as in @eq-arima.

::: {.callout-note icon=false}

## Example: SARIMA for the number of airline passengers

Here we revisit the time series on airline passengers from which we have removed the trend by taking regular non-seasonal differences once ($d = 1$). 
Notice from @fig-AirDiff C and D how after taking the usual differences the upward trend disappeared, and ACF started to decay much faster. 
At the seasonal lags, however, the ACF decays still linearly (@fig-AirDiff D), which suggested differencing at the seasonal lag to remove strong periodicity. 
After taking seasonal differences once ($D = 1$), the time series looks stationary (@fig-AirDiff E), and the ACF decays fast at both seasonal and non-seasonal lags. 
This is enough differencing.


::: {.cell}

```{.r .cell-code}
Yt <- log10(AirPassengers)

# Apply first-order (non-seasonal) differences
D1 <- diff(Yt)

# Additionally, apply first-order seasonal differences
D1D12 <- diff(D1, lag = 12)

p1 <- ggplot2::autoplot(Yt) + 
    xlab("Year") + 
    ylab("lg(Air passangers)") + 
    ggtitle("Yt")
p2 <- forecast::ggAcf(Yt) + 
    ggtitle("Yt") +
    xlab("Lag (months)")
p3 <- ggplot2::autoplot(D1) + 
    xlab("Year") + 
    ylab("lg(Air passangers)") + 
    ggtitle("(1-B)Yt")
p4 <- forecast::ggAcf(D1) + 
    ggtitle("(1-B)Yt") +
    xlab("Lag (months)")
p5 <- ggplot2::autoplot(D1D12) + 
    xlab("Year") + 
    ylab("lg(Air passangers)") + 
    ggtitle("(1-B)(1-B12)Yt")
p6 <- forecast::ggAcf(D1D12) + 
    ggtitle("(1-B)(1-B12)Yt") +
    xlab("Lag (months)")
(p1 + p2) / (p3 + p4) / (p5 + p6) +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Time series plot of the airline passenger series with an estimated ACF and the detrended (differenced) series with their ACFs.](advml-fundamentals_files/figure-html/fig-AirDiff-1.png){#fig-AirDiff width=768}
:::
:::


For the next step, see @fig-AirDiffACF to identify the orders $p$ and $q$. 
For that, look only at the non-seasonal lags, 1--11. 
Both ACF and PACF have significant values at lags 1 and 3, which could correspond to AR(3), MA(3), ARMA(1,1), or ARMA with higher orders. 
From these options ARMA(1,1) has fewer parameters, hence we prefer this model, with $p = 1$ and $q = 1$, as the most parsimonious option. 
(However, given that the correlations at lag 2 are not statistically significant, information criteria may penalize adding extra arguments and might prefer a more compact specification, AR(1) or MA(1).)

Next, use @fig-AirDiffACF again to identify orders $P$ and $Q$. 
Now look only at the seasonal lags 12, 24, 36, etc. 
Both the ACF and PACF have significant values only on the first of those lags (lag 12), which could correspond to AR(1), MA(1), or ARMA(1,1) for the seasonal component. 
From these options, AR(1) and MA(1) are the most parsimonious so we should select one of them or use some numeric criterion to select the best model (e.g., information criterion like AIC or forecasting accuracy on a testing set).


::: {.cell}

```{.r .cell-code}
p6 <- forecast::ggAcf(D1D12, lag.max = 36) + 
    ggtitle("(1-B)(1-B12)Yt") +
    xlab("Lag (months)")
p7 <- forecast::ggAcf(D1D12, lag.max = 36, type = "partial") + 
    ggtitle("(1-B)(1-B12)Yt") +
    xlab("Lag (months)")
p6 + p7 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![ACF and PACF of the differenced airline passenger time series $(1-B)(1-B^{12})Y_t$.](advml-fundamentals_files/figure-html/fig-AirDiffACF-1.png){#fig-AirDiffACF width=768}
:::
:::


Overall, our analysis suggested that SARIMA(1,1,1)(1,1,0) or SARIMA(1,1,1)(0,1,1) is a plausible model for this time series.
For example, estimate SARIMA(1,1,1)(0,1,1):


::: {.cell}

```{.r .cell-code  code-fold="false"}
mod_air <- stats::arima(Yt, order = c(1, 1, 1),
                        seasonal = list(order = c(0, 1, 1),
                                        period = 12))
mod_air
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> stats::arima(x = Yt, order = c(1, 1, 1), seasonal = list(order = c(0, 1, 1), 
#>     period = 12))
#> 
#> Coefficients:
#>         ar1     ma1    sma1
#>       0.196  -0.578  -0.564
#> s.e.  0.247   0.213   0.075
#> 
#> sigma^2 estimated as 0.000253:  log likelihood = 354,  aic = -700
```


:::
:::


SARIMA(1,1,1)(0,1,1)$_{12}$ model can be written down as
$$
\begin{split}
(1 - B) (1 - \phi_1B) (1 - B^{12}) X_t \\
= (1 + \theta_1B) (1 + \Theta_1B^{12})Z_t.
\end{split}
$$
We can apply the backshift operations are rewrite the model without the backshift operator as follows:
$$
\begin{split}
(1 - B - \phi_1B + \phi_1B^2) (1 - B^{12}) X_t \\
= (1 + \theta_1B + \Theta_1B^{12} + \theta_1\Theta_1B^{13})Z_t,
\end{split}
$$
then
$$
\begin{split}
(1 - B - \phi_1B + \phi_1B^2 - B^{12} + B^{13} + \phi_1B^{13} - \phi_1B^{14}) X_t \\
= (1 + \theta_1B + \Theta_1B^{12} + \theta_1\Theta_1B^{13})Z_t,
\end{split}
$$
then
$$
\begin{split}
X_t - X_{t-1} - \phi_1X_{t-1} + \phi_1X_{t-2} - X_{t-12} + X_{t-13} + \phi_1X_{t-13} - \phi_1X_{t-14} \\
= Z_t + \theta_1Z_{t-1} + \Theta_1Z_{t-12} + \theta_1\Theta_1Z_{t-13},
\end{split}
$$
then
$$
\begin{split}
X_t = X_{t-1} + \phi_1X_{t-1} - \phi_1X_{t-2} + X_{t-12} - X_{t-13} - \phi_1X_{t-13} + \phi_1X_{t-14} \\
+ \theta_1Z_{t-1} + \Theta_1Z_{t-12} + \theta_1\Theta_1Z_{t-13} + Z_t,
\end{split}
$$
where $X_t = \lg(AirPassengers)$ and $Z_t\sim \mathrm{WN}(0,\sigma^2)$.

Below are results based on the automatic selection of the orders:


::: {.cell}

```{.r .cell-code  code-fold="false"}
forecast::auto.arima(Yt)
```

::: {.cell-output .cell-output-stdout}

```
#> Series: Yt 
#> ARIMA(0,1,1)(0,1,1)[12] 
#> 
#> Coefficients:
#>          ma1    sma1
#>       -0.402  -0.557
#> s.e.   0.090   0.073
#> 
#> sigma^2 = 0.000259:  log likelihood = 354
#> AIC=-702   AICc=-702   BIC=-693
```


:::
:::


The orders selected automatically based on AIC suggest that indeed the non-significance of correlations at lag 2 and relatively low correlations at lag 3 made it not worthy to estimate additional parameters in the non-seasonal part, for which MA(1) specification was selected, not the suggested ARMA(1,1), AR(3), or MA(3).

In the next step, we apply diagnostic checks for the residuals, for example, using plots (@fig-AirARIMAres).


::: {.cell}

```{.r .cell-code}
e <- mod_air$residuals
p1 <- ggplot2::autoplot(e) + 
    ylab("Residuals")
p2 <- forecast::ggAcf(e) +
    ggtitle("")
p3 <- ggpubr::ggqqplot(e) + 
    xlab("Standard normal quantiles")
p1 / (p2 + p3) +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Residual diagnostics for the SARIMA model for the airline passenger data.](advml-fundamentals_files/figure-html/fig-AirARIMAres-1.png){#fig-AirARIMAres width=768}
:::
:::


Given that the diagnostics plots show satisfactory behavior of the residuals (@fig-AirARIMAres), continue with forecasting using this model (@fig-AirARIMAfcst).


::: {.cell}

```{.r .cell-code}
ggplot2::autoplot(forecast::forecast(mod_air, h = 24)) + 
    xlab("Year") +
    ylab("lg(Air passangers)") +
    ggtitle("")
```

::: {.cell-output-display}
![SARIMA model predictions of airline passenger data 2 years ahead.](advml-fundamentals_files/figure-html/fig-AirARIMAfcst-1.png){#fig-AirARIMAfcst width=768}
:::
:::


Compare ACF in @fig-AirARIMAres with ACF of regression residuals in @fig-airpassangersRegTrendSeas and @fig-airpassangersRegTrendFourier. 
The residuals of those regression models are autocorrelated, while the models have more parameters than the specified SARIMA models. 
Hence, the SARIMA model is much better for this time series.
:::


## Conclusion

In this lecture, we discovered ARIMA as an extension of ARMA modeling to nonstationary data and SARIMA as an extension of ARIMA models to time series with periodicity (seasonality).

We learned Box--Jenkins iterative procedure for identifying such models, including the orders of differences, $d$ and $D$, and $p$, $q$, $P$, and $Q$.

Please remember to specify the criterion for selecting a model beforehand and consider such options as cross-validation and using a testing set.


## Appendix

**Equivalences**

Mathematically, some models are equivalent one to another. Below are some examples.

* Forecasts of ARIMA(0,1,1) are equivalent to simple exponential smoothing.

An ARIMA(0,1,1) model can be written as 
$$
Y_t = Y_{t-1} + \theta_1 Z_{t-1} + Z_t,
$$
from which the one-step-ahead forecast is
$$
\hat{Y}_t = Y_{t-1} + \theta_1 (Y_{t-1} - \hat{Y}_{t-1}).
$$
If we define $\theta_1 = \alpha - 1$, then the above equation transforms to
$$
\begin{split}
\hat{Y}_t &= Y_{t-1} + (\alpha - 1) (Y_{t-1} - \hat{Y}_{t-1})\\
&= Y_{t-1} + (\alpha - 1) Y_{t-1} - (\alpha - 1) \hat{Y}_{t-1}\\
&= \alpha Y_{t-1} + (1 - \alpha) \hat{Y}_{t-1}
\end{split}
$$

* Forecasts of ARIMA(0,2,2) are equivalent to Holt's method.

* Forecasts of SARIMA(0,1,$s+1$)(0,1,0)$_s$ are equivalent to Holt--Winters additive method.
-->


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./deep-learning.html" class="pagination-link" aria-label="Autoregressive Moving Average (ARMA) Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./whitebox-attacks.html" class="pagination-link" aria-label="Adversarial Machine Learning">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Adversarial Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/kundan-kumarr/StatSphere/edit/master/advml-fundamentals.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kundan-kumarr/StatSphere/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>