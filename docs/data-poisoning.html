<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>7&nbsp; Black-box Evasion Attack – Safe AI for Cyber-Physical &amp; Intelligent Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./defenses-advml.html" rel="next">
<link href="./blackbox-attacks.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advml-fundamentals.html">Part II — Adversarial Machine Learning</a></li><li class="breadcrumb-item"><a href="./data-poisoning.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-box Evasion Attack</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Safe AI for Cyber-Physical &amp; Intelligent Systems</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/kundan-kumarr/StatSphere/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Safe-AI-for-Cyber-Physical---Intelligent-Systems.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Safe-AI-for-Cyber-Physical---Intelligent-Systems.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I — Foundations of Safe Intelligent Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-ai-security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml-for-cps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II — Adversarial Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advml-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whitebox-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Adversarial Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blackbox-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-poisoning.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./defenses-advml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Poisoning Attacks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III — Attacks on Large Language Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prompt-injection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prompt-extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adversarial Machine Learning in Malware</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Adversarial LLMs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./memory-poisoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Adversarial LLMs1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rag-poisoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jailbreak-automation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV — Defenses for Large Language Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./defensive-prompts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool-gating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rag-security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monitoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./governance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V — Safe AI for Cyber-Physical Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./safe-rl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cps-attacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cps-defenses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI — Methods for Research, Evaluation &amp; Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research-directions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Adversarial LLMs1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./writing-papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VII — Alignment &amp; Safe Autonomous Agents</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alignment-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Deep Learning Models Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goal-misgeneralization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Defense against evasion attacks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deceptive-alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rlhf-constitutional-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./safe-agent-architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alignment-for-cps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./open-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Fundamental of AI and Cybersecurity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-prompt-engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Weighted least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-eval-checklists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Generalized least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-security-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Synchrony of parametric trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-datasets-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Analysis of precipitation extremes and climate projections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-tools-libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Practice exercises</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advml-fundamentals.html">Part II — Adversarial Machine Learning</a></li><li class="breadcrumb-item"><a href="./data-poisoning.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-box Evasion Attack</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Black-box Evasion Attack</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!--
The goal of this lecture is to introduce methods of handling nonstationary time series in regression models. 
You will become familiar with the problem of spurious correlation (regression) and approaches helping to avoid it.

**Objectives**

1. Learn three alternative ways of handling trends and/or seasonality to avoid spurious results: incorporate time effects into a regression model, use deviations from trends, or differenced series.
1. Introduce the concept of cointegration, learn how to detect it, and model using an error correction model.

**Reading materials**

* Chapter 10 in @Wooldridge:2013
* Chapter 6 in @Kirchgassner:Wolters:2007 on cointegration


## Spurious correlation

Results of statistical analysis (correlation, regression, etc.) are called *spurious* when they are likely driven not by the underlying mechanisms such as the physical relationships between variables, but by matching patterns (often, temporal patterns) of the variables leading to the statistical significance of tested relationships. 
Such matching patterns include trends, periodic fluctuations (seasonality), and more random patterns like spikes matching in several time series, for example, detected by searching over a large database of time series (a.k.a. cherry picking).


::: {.cell}

```{.r .cell-code}
set.seed(123)
T <- 300
Xt <- ts(rnorm(T))
Yt <- ts(rnorm(T))
p1 <- forecast::autoplot(Xt)
p2 <- forecast::autoplot(Yt)
p1 + p2 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Original stationary and independent time series.](data-poisoning_files/figure-html/fig-orig-1.png){#fig-orig width=768}
:::
:::


@fig-orig shows two series of length $T = 300$ simulated from the standard normal distribution, $N(0,1)$.
These are independent and identically distributed (i.i.d.) random variables: each of the $T$ values in $X_t$ and $Y_t$ was drawn independently from other values from the same distribution. 
Two random variables are independent if the realization of one does not affect the probability distribution of the other. 
Independence is a strong condition, it also implies (includes) that the values are not correlated. 
This is true both for the values within the series $X_t$ and $Y_t$, and across $X_t$ and $Y_t$ (i.e., $X_t$ and $Y_t$ are not autocorrelated, nor correlated with each other). 
This is the asymptotic property of such a time series (as the sample size increases infinitely).

In finite samples, we may observe that a point estimate of the correlation coefficient even for such an ideal series is not exactly zero, but it will be usually not statistically significant. 
See the results (confidence interval and $p$-value) from the correlation $t$-test below:


::: {.cell}

```{.r .cell-code  code-fold="false"}
cor.test(Xt, Yt)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Pearson's product-moment correlation
#> 
#> data:  Xt and Yt
#> t = -1, df = 298, p-value = 0.3
#> alternative hypothesis: true correlation is not equal to 0
#> 95 percent confidence interval:
#>  -0.1727  0.0529
#> sample estimates:
#>     cor 
#> -0.0607
```


:::
:::


Not many time series behave like that in real life -- often we observe some trends. Let's add linear trends to our simulated data, for example, trends going in the same direction but with slopes of different magnitudes. 
Here we use linear increasing trends, i.e., with positive slopes [@fig-TSwithTrends].

::: {.callout-note}
It is probably a good idea to refrain from writing 'positive trends' (or 'negative trends') because they can be confused with 'good' or 'beneficial' trends. 
For example, a decrease in the unemployment rate is a positive (good) trend for a country, but it is a trend with a negative slope. 
Contrary, a linear trend in pollutant concentrations with a positive slope (going upward) shows a negative (worsening) tendency for the ecosystem.
:::


::: {.cell}

```{.r .cell-code}
Xt <- Xt + c(1:T)/95
Yt <- Yt + c(1:T)/50
p1 <- forecast::autoplot(Xt) +
    ylim(-2, 8)
p2 <- forecast::autoplot(Yt) +
    ylim(-2, 8)
p1 + p2 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Time series with trends.](data-poisoning_files/figure-html/fig-TSwithTrends-1.png){#fig-TSwithTrends width=768}
:::
:::


After adding trends to each of the time series, the correlation of $X_t$ and $Y_t$ is strong and statistically significant, but this is not necessarily because these series are so strongly related to each other. 


::: {.cell}

```{.r .cell-code  code-fold="false"}
cor.test(Xt, Yt)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Pearson's product-moment correlation
#> 
#> data:  Xt and Yt
#> t = 13, df = 298, p-value <2e-16
#> alternative hypothesis: true correlation is not equal to 0
#> 95 percent confidence interval:
#>  0.519 0.665
#> sample estimates:
#>   cor 
#> 0.597
```


:::
:::


Some other factors may be driving the dynamics (trends) of $X_t$ and $Y_t$ in the same direction. 
Also, recall the general formula for computing correlation (or autocorrelation) of time series and that we need to subtract time-dependent means (not just a mean calculated over the whole period assuming the mean is not changing or time-independent), for example, as in @eq-Cov.

For example, a city's growing population may result in more police officers and heavier pollution at the same time, partially because more people will drive their vehicles in the city. 
An attempt to correlate (regress) pollution with the number of police officers will produce a so-called spurious correlation (regression). 
The results of statistical tests will be likely statistically significant. 
However, is pollution directly related to the number of police officers? 
Will the dismissal of a police officer help to make the air cleaner?

Not only common increasing/decreasing trends but also other systematic changes (such as seasonality) may be responsible for spurious correlation effects. 
For example, both high ice cream sales and harmful algal blooms typically occur in warm weather conditions and may be 'significantly' correlated, suggesting banning ice cream for the sake of a safer environment. 
See more interesting examples of spurious correlation at <http://www.tylervigen.com/spurious-correlations>.

Sometimes, some simple tricks may help to avoid spurious results. 
For example, analyze not the raw numbers, but the *rates* that remove the effect of population growth in a city: crime rate per 100,000 inhabitants, number of people older than 70 per 1,000 inhabitants, etc. 
For more general approaches, see the next section.


## Common approaches to regressing time series with trends

Consider a situation when we are given time series with trends (like in @fig-TSwithTrends), we do not know the data generating process (DGP; i.e., the true dependence structure), and we want to use these series in regression analysis.

In general, there are three alternative ways of dealing with trends in regression:

1. Incorporate time effect into the model;
1. Use deviations from trends (i.e., model and remove trends), or
1. Use differenced series (i.e., remove trends by differencing).

After these three approaches, here we consider a special case of cointegration (@sec-cointegration).


### Incorporate time effects {#sec-incorporateTime}

Based on the time series plots (@fig-TSwithTrends), a linear time trend would fit these data, since we see a linear increase of values with time (so we add a linear time effect $t$ in our model). 
Alternatively, e.g., if we observed parabolic structure, we could include $t+t^2$ or another form of trend.


::: {.cell}

```{.r .cell-code  code-fold="false"}
t <- c(1:T)
mod_time <- lm(Yt ~ Xt + t)
summary(mod_time)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = Yt ~ Xt + t)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -2.7564 -0.6069  0.0546  0.6404  2.5802 
#> 
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  0.000813   0.114665    0.01     0.99    
#> Xt          -0.063741   0.060617   -1.05     0.29    
#> t            0.020741   0.000939   22.09   <2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.99 on 297 degrees of freedom
#> Multiple R-squared:  0.756,  Adjusted R-squared:  0.755 
#> F-statistic:  461 on 2 and 297 DF,  p-value: <2e-16
```


:::
:::


This model looks like this:
$$
Y_t = \beta_0 + \beta_1X_t + \beta_2t + \epsilon_t,
$$
estimated as:
\begin{align}
\widehat{Y}_t &= \hat{\beta}_0 + \hat{\beta}_1X_t + \hat{\beta}_2t,\\
\widehat{Y}_t &=  0.0008 - 0.0637X_t + 0.0207t.
\end{align}

In the above model, the (highly statistically significant) time term took over the trend influence, thus, the coefficient for $X$ shows the 'real' relationship between $Y$ and $X$. 
Notice, the coefficient $\beta_1$ is not statistically significant, what we expected.


### Use deviations from trends

Here we fit a separate time trend (may be of a different form for each time series: linear, quadratic, log, etc.) for each variable and find deviations from these trends. 
Based on @fig-TSwithTrends, linear trends are appropriate here:
$$
Y_t = a_0 + a_1t + e_{(Y)t}; \quad X_t = b_0 + b_1t + e_{(X)t},
$$
where $e_{(Y)t}$ and $e_{(X)t}$ are the trend residuals for the series $Y_t$ and $X_t$, respectively.

After the trend coefficients $a_0$, $a_1$, $b_0$, and $b_1$ are estimated,


::: {.cell}

```{.r .cell-code  code-fold="false"}
MY <- lm(Yt ~ t)
MX <- lm(Xt ~ t)
```
:::

    
the smoothed series are
$$
\widetilde{Y}_t = \hat{a}_0 + \hat{a}_1t; \quad \widetilde{X}_t = \hat{b}_0 + \hat{b}_1t
$$
and the estimated trend residuals are (@fig-trendresid)
$$
\hat{e}_{(Y)t} = Y_t - \widetilde{Y}_t\quad\text{and}\quad \hat{e}_{(X)t} = X_t - \widetilde{X}_t.
$$


::: {.cell}

```{.r .cell-code}
p1 <- ggplot2::autoplot(as.ts(MY$resid)) +
    xlab("t") +
    ylab("eYt")
p2 <- ggplot2::autoplot(as.ts(MX$resid)) +
    xlab("t") +
    ylab("eXt")
p1 + p2 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Residuals from individually estimated linear trends.](data-poisoning_files/figure-html/fig-trendresid-1.png){#fig-trendresid width=768}
:::
:::


Use the residuals in our regression model in place of the original variables:
$$
\hat{e}_{(Y)t} = \beta_0 + \beta_1\hat{e}_{(X)t} + \epsilon_t.
$$


::: {.cell}

```{.r .cell-code  code-fold="false"}
mod_devTrend <- lm(MY$residuals ~ MX$residuals)
summary(mod_devTrend)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = MY$residuals ~ MX$residuals)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -2.7564 -0.6069  0.0546  0.6404  2.5802 
#> 
#> Coefficients:
#>               Estimate Std. Error t value Pr(>|t|)
#> (Intercept)   1.05e-17   5.71e-02    0.00     1.00
#> MX$residuals -6.37e-02   6.05e-02   -1.05     0.29
#> 
#> Residual standard error: 0.989 on 298 degrees of freedom
#> Multiple R-squared:  0.00371,    Adjusted R-squared:  0.000366 
#> F-statistic: 1.11 on 1 and 298 DF,  p-value: 0.293
```


:::
:::


We got the result (the relationship between the variables is not statistically significant) similar to running the model incorporating time trends in @sec-incorporateTime. 
Again, it is a reasonable result based on how the time series were simulated (independent, although with trends in the same direction).


### Use differenced series {#sec-RegTrendDiff}

Instead of assuming a deterministic trend as in the previous subsections, we can try to eliminate a stochastic trend by differencing the time series. 
We define the lag-1 difference operator $\Delta$ by
$$
\Delta X_t = X_t - X_{t-1} = (1-B)X_t,
$$
where $B$ is the backward shift operator, $BX_t = X_{t-1}$.

There are tests developed in econometrics to find the appropriate order of differences (unit-root tests). 
Here, however, we will use the rule of thumb: for time trends looking linear (our case, see @fig-TSwithTrends) use the first-order differences, for parabolic shapes -- the second-order differences. 
After differencing, the series should look stationary.

The first-order differences for our series (@fig-TSdiffed) can be calculated as follows:


::: {.cell}

```{.r .cell-code  code-fold="false"}
D1X <- diff(Xt)
D1Y <- diff(Yt)
```
:::



::: {.cell}

```{.r .cell-code}
p1 <- ggplot2::autoplot(D1Y) +
    xlab("t")
p2 <- ggplot2::autoplot(D1X) +
    xlab("t")
p1 + p2 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![First-order differences of the time series.](data-poisoning_files/figure-html/fig-TSdiffed-1.png){#fig-TSdiffed width=768}
:::
:::


The series of first-order differences look stationary (@fig-TSdiffed). 
Use these differenced series instead of the original time series in a regression model:
$$
\Delta Y_t = \beta_0 + \beta_1 \Delta X_t + \epsilon_t.
$$


::: {.cell}

```{.r .cell-code  code-fold="false"}
mod_diff <- lm(D1Y ~ D1X)
summary(mod_diff)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = D1Y ~ D1X)
#> 
#> Residuals:
#>    Min     1Q Median     3Q    Max 
#> -4.056 -1.050  0.178  1.005  5.028 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)
#> (Intercept)   0.0284     0.0840    0.34     0.74
#> D1X           0.0114     0.0620    0.18     0.85
#> 
#> Residual standard error: 1.45 on 297 degrees of freedom
#> Multiple R-squared:  0.000114,   Adjusted R-squared:  -0.00325 
#> F-statistic: 0.0338 on 1 and 297 DF,  p-value: 0.854
```


:::
:::


As expected (since the original series $X_t$ and $Y_t$, before adding the trend, were uncorrelated), the coefficient $\beta_1$ and the whole regression model are not statistically significant.


### Wrong approach (do not repeat at home) leading to spurious regression

What if we forget about the three approaches above and just use the time series with trends in a regression model? 
This could be such a model:
$$
Y_t = \beta_0 + \beta_1X_t + \epsilon_t.
$$


::: {.cell}

```{.r .cell-code  code-fold="false"}
badModel <- lm(Yt ~ Xt)
summary(badModel)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = Yt ~ Xt)
#> 
#> Residuals:
#>    Min     1Q Median     3Q    Max 
#> -4.022 -1.020  0.098  1.219  4.091 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)   1.5812     0.1454    10.9   <2e-16 ***
#> Xt            0.8883     0.0692    12.8   <2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 1.61 on 298 degrees of freedom
#> Multiple R-squared:  0.356,  Adjusted R-squared:  0.354 
#> F-statistic:  165 on 1 and 298 DF,  p-value: <2e-16
```


:::
:::


The bad model shows spurious statistically significant effects, which are not true.

*Beware of trends!*

::: {.callout-note icon=false}

## Example: Predicting sales of home appliances

Recall the dishwasher example from the first lecture. 
Let's use the above methods for regressing the time series of dishwasher shipments ($DISH_t$) and residential investments ($RES_t$).

First, look at the time series plots of the raw data (@fig-TSdish).


::: {.cell}

```{.r .cell-code}
D <- read.delim("data/dish.txt") %>% 
    rename(Year = YEAR)
p1 <- ggplot(D, aes(x = Year, y = DISH)) + 
    geom_line()
p2 <- ggplot(D, aes(x = Year, y = RES)) + 
    geom_line()
p1 + p2 + 
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Time series plots of the dishwasher shipments (DISH) and residential investments (RES).](data-poisoning_files/figure-html/fig-TSdish-1.png){#fig-TSdish width=768}
:::
:::


**Incorporate time effects**

Incorporate linear trend using the model
$$
DISH_t = \beta_0 + \beta_1 RES_t + \beta_2 Year + \epsilon_t;
$${#eq-dishtimetrend}
see the residual diagnostics below and in @fig-dishtimetrend. 


::: {.cell}

```{.r .cell-code  code-fold="false"}
M_time <- lm(DISH ~ RES + Year, data = D)
summary(M_time)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = DISH ~ RES + Year, data = D)
#> 
#> Residuals:
#>    Min     1Q Median     3Q    Max 
#> -508.6 -237.7  -52.1  236.1  859.9 
#> 
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept) -1.32e+05   2.32e+04   -5.71  8.1e-06 ***
#> RES          5.89e+01   9.35e+00    6.29  2.0e-06 ***
#> Year         6.69e+01   1.19e+01    5.63  1.0e-05 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 353 on 23 degrees of freedom
#> Multiple R-squared:  0.893,  Adjusted R-squared:  0.884 
#> F-statistic: 96.3 on 2 and 23 DF,  p-value: 6.65e-12
```


:::
:::



::: {.cell}

```{.r .cell-code  code-fold="false"}
shapiro.test(M_time$residuals)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Shapiro-Wilk normality test
#> 
#> data:  M_time$residuals
#> W = 1, p-value = 0.4
```


:::

```{.r .cell-code  code-fold="false"}
lawstat::runs.test(M_time$residuals, plot.it = FALSE)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Runs Test - Two sided
#> 
#> data:  M_time$residuals
#> Standardized Runs Statistic = -4, p-value = 3e-04
```


:::
:::



::: {.cell}

```{.r .cell-code}
p1 <- ggplot(D, aes(x = Year, y = M_time$residuals)) + 
    geom_line() + 
    geom_hline(yintercept = 0, lty = 2, col = 4) + 
    ylab("Residuals")
p2 <- forecast::ggAcf(M_time$residuals) +
    ggtitle("") +
    xlab("Lag (years)")
p3 <- ggpubr::ggqqplot(M_time$residuals) + 
    xlab("Standard normal quantiles")
p1 + p2 + p3 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Diagnostics plots for residuals from @eq-dishtimetrend.](data-poisoning_files/figure-html/fig-dishtimetrend-1.png){#fig-dishtimetrend width=768}
:::
:::


**Use differenced time series**

Difference the time series (@fig-TSdishdiff) to use in the model
$$
\Delta DISH_t = \beta_0 + \beta_1 \Delta RES_t + \epsilon_t
$${#eq-dishdiff}
see the residual diagnostics below and in @fig-dishdiff. 


::: {.cell}

```{.r .cell-code  code-fold="false"}
D_DISH <- diff(D$DISH)
D_RES <- diff(D$RES)
M_diff <- lm(D_DISH ~ D_RES)
summary(M_diff)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = D_DISH ~ D_RES)
#> 
#> Residuals:
#>    Min     1Q Median     3Q    Max 
#> -424.4 -121.3    4.4   72.3  498.0 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)    71.22      43.16    1.65     0.11    
#> D_RES          44.14       6.07    7.27  2.1e-07 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 213 on 23 degrees of freedom
#> Multiple R-squared:  0.697,  Adjusted R-squared:  0.684 
#> F-statistic: 52.8 on 1 and 23 DF,  p-value: 2.13e-07
```


:::
:::



::: {.cell}

```{.r .cell-code}
p1 <- ggplot(D[-1,], aes(x = Year, y = D_DISH)) + 
    geom_line() + 
    geom_hline(yintercept = 0, lty = 2, col = 4)
p2 <- ggplot(D[-1,], aes(x = Year, y = D_RES)) + 
    geom_line() + 
    geom_hline(yintercept = 0, lty = 2, col = 4)
p3 <- ggplot(data.frame(D_DISH, D_RES), aes(y = D_DISH, x = D_RES)) +
    geom_point()
p1 + p2 + p3 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Time differences of dishwasher shipments and residential investments, and a scatterplot for assessing pairwise relationships.](data-poisoning_files/figure-html/fig-TSdishdiff-1.png){#fig-TSdishdiff width=768}
:::
:::



::: {.cell}

```{.r .cell-code  code-fold="false"}
shapiro.test(M_diff$residuals)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Shapiro-Wilk normality test
#> 
#> data:  M_diff$residuals
#> W = 1, p-value = 0.8
```


:::

```{.r .cell-code  code-fold="false"}
lawstat::runs.test(M_diff$residuals, plot.it = FALSE)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Runs Test - Two sided
#> 
#> data:  M_diff$residuals
#> Standardized Runs Statistic = -2, p-value = 0.07
```


:::
:::



::: {.cell}

```{.r .cell-code}
p1 <- ggplot(D[-1,], aes(x = Year, y = M_diff$residuals)) + 
    geom_line() + 
    geom_hline(yintercept = 0, lty = 2, col = 4) + 
    ylab("Residuals")
p2 <- forecast::ggAcf(M_diff$residuals) +
    ggtitle("") +
    xlab("Lag (years)")
p3 <- ggpubr::ggqqplot(M_diff$residuals) + 
    xlab("Standard normal quantiles")
p1 + p2 + p3 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Diagnostics plots for residuals from @eq-dishdiff.](data-poisoning_files/figure-html/fig-dishdiff-1.png){#fig-dishdiff width=768}
:::
:::

:::


## Cointegration {#sec-cointegration}

Generally, cointegration might be characterized by two or more I(1) variables indicating a common long-run development, i.e., the variables do not drift away from each other except for transitory fluctuations. 
This defines a statistical equilibrium that, in empirical analysis, can often be interpreted as a long-run [economic] relation [@Engle:Granger:1987].

In other words, two I(1) series $X_t$ and $Y_t$ are cointegrated if their linear combination $u_t$ is I(0):
$$
Y_t - \beta X_t = u_t.
$${#eq-longrun}

Cointegration means a common stochastic trend (see @sec-syncparam on testing for a common parametric trend). 
The vector $(1, -\beta)^{\top}$ is called the *cointegration vector*.

For the development of methods of analyzing time series cointegration, in 2003, [Clive W. J. Granger was awarded 1/2 of the Sveriges Riksbank Prize in Economic Sciences in Memory of Alfred Nobel](https://www.nobelprize.org/prizes/economic-sciences/2003/granger/facts/) (the other half was awarded to R. Engle, see @sec-GARCH).


### Two-step Engle--Granger method

1. Estimate long-run relationship, i.e., regression in levels as in @eq-longrun, and test residuals for I(0).
1. If the residual series $u_t$ is I(0), use it in *error correction model* (ECM) regression
$$
\begin{split}
\Delta Y_t &= a_0 -\gamma_Y(Y_{t-1}-\beta X_{t-1})+\sum_{j=1}^{n_X}a_{Xj}\Delta X_{t-j}+\sum_{j=1}^{n_Y}a_{Yj}\Delta Y_{t-j} + u_{Y,t},\\
\Delta X_t &= b_0 +\gamma_X(Y_{t-1}-\beta X_{t-1})+\sum_{j=1}^{k_X}b_{Xj}\Delta X_{t-j}+\sum_{j=1}^{k_Y}b_{Yj}\Delta Y_{t-j} + u_{X,t},
\end{split}
$${#eq-ecm}
where $u_X$ and $u_Y$ are pure random processes. 
If $X_t$ and $Y_t$ are cointegrated, at least one $\gamma_i$, $i = X, Y$, has to be different from zero.

OLS estimator is super consistent, convergence $T$. 
However, OLS can be biased in small samples.

The representation in @eq-ecm has the advantage that it only contains stationary variables, although the underlying relation is between nonstationary (I(1)) variables. 
Thus, if the variables are cointegrated and the cointegration vector is known, the traditional statistical procedures can be applied for estimation and testing.

::: {.callout-note icon=false}

## Example: Error correction model for simulated data


::: {.cell}

:::


Demonstrate the analysis using simulated time series (@fig-XYi1).


::: {.cell}

```{.r .cell-code}
p1 <- ggplot2::autoplot(Xt)
p2 <- ggplot2::autoplot(Yt)
p1 + p2 +
    plot_annotation(tag_levels = 'A')
```

::: {.cell-output-display}
![Simulated I(1) time series.](data-poisoning_files/figure-html/fig-XYi1-1.png){#fig-XYi1 width=768}
:::
:::


Apply unit-root test to check the integration order of each series, using the R package `tseries`:


::: {.cell}

```{.r .cell-code  code-fold="false"}
tseries::adf.test(Xt)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  Xt
#> Dickey-Fuller = -2, Lag order = 6, p-value = 0.5
#> alternative hypothesis: stationary
```


:::

```{.r .cell-code  code-fold="false"}
tseries::adf.test(diff(Xt))
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  diff(Xt)
#> Dickey-Fuller = -7, Lag order = 6, p-value = 0.01
#> alternative hypothesis: stationary
```


:::

```{.r .cell-code  code-fold="false"}
tseries::adf.test(Yt)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  Yt
#> Dickey-Fuller = -2, Lag order = 6, p-value = 0.5
#> alternative hypothesis: stationary
```


:::

```{.r .cell-code  code-fold="false"}
tseries::adf.test(diff(Yt))
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  diff(Yt)
#> Dickey-Fuller = -8, Lag order = 6, p-value = 0.01
#> alternative hypothesis: stationary
```


:::
:::


With the confidence of 95%, the ADF test results show that each of the time series, $X_t$ and $Y_t$, are I(1). 
(However, we have used the test 4 times, without controlling the overall Type I error.)

Fit the linear regression
$$
Y_t = a + bX_t + u_t.
$${#eq-longr}
The vector $[1, -b]$ is the cointegration vector.


::: {.cell}

```{.r .cell-code  code-fold="false"}
Ut <- lm(Yt ~ Xt)$residuals
tseries::adf.test(Ut)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  Ut
#> Dickey-Fuller = -5, Lag order = 6, p-value = 0.01
#> alternative hypothesis: stationary
```


:::
:::


While each of the time series $X_t$ and $Y_t$ is I(1), the resulting residual series $u_t \sim \mathrm{I}(0)$, thus we conclude, $X_t$ and $Y_t$ are cointegrated.

Apply a simple error correction model (with $n_X = n_Y = 1$), using the R package `dynlm` or just specify lags using the package `dplyr`:


::: {.cell}

```{.r .cell-code  code-fold="false"}
# Error correction term
ect <- Ut[-length(Ut)]

# Differenced series
dy <- diff(Yt)
dx <- diff(Xt)
```
:::


Model using `dynlm::dynlm()`:
 

::: {.cell}

```{.r .cell-code  code-fold="false"}
library(dynlm)
ecmdat1 <- cbind(dy, dx, ect)
ecm1 <- dynlm(dy ~ L(ect, 1) + L(dy, 1) + L(dx, 1), data = ecmdat1)
summary(ecm1)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Time series regression with "ts" data:
#> Start = 3, End = 250
#> 
#> Call:
#> dynlm(formula = dy ~ L(ect, 1) + L(dy, 1) + L(dx, 1), data = ecmdat1)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -1.8348 -0.3860 -0.0224  0.3696  1.5586 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  0.00919    0.03588    0.26   0.7980    
#> L(ect, 1)   -0.67417    0.07482   -9.01   <2e-16 ***
#> L(dy, 1)    -0.49772    0.07341   -6.78    9e-11 ***
#> L(dx, 1)     0.22842    0.07906    2.89   0.0042 ** 
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.565 on 244 degrees of freedom
#> Multiple R-squared:  0.265,  Adjusted R-squared:  0.256 
#> F-statistic: 29.3 on 3 and 244 DF,  p-value: 3.2e-16
```


:::
:::


Model using `lm()` and `dplyr::lag()`:


::: {.cell}

```{.r .cell-code  code-fold="false"}
ecm2 <- lm(dy ~ dplyr::lag(ect, 1) + 
               dplyr::lag(as.vector(dy), 1) + 
               dplyr::lag(as.vector(dx), 1))
summary(ecm2)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> Call:
#> lm(formula = dy ~ dplyr::lag(ect, 1) + dplyr::lag(as.vector(dy), 
#>     1) + dplyr::lag(as.vector(dx), 1))
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -1.8348 -0.3860 -0.0224  0.3696  1.5586 
#> 
#> Coefficients:
#>                              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)                   0.00919    0.03588    0.26   0.7980    
#> dplyr::lag(ect, 1)           -0.67417    0.07482   -9.01   <2e-16 ***
#> dplyr::lag(as.vector(dy), 1) -0.49772    0.07341   -6.78    9e-11 ***
#> dplyr::lag(as.vector(dx), 1)  0.22842    0.07906    2.89   0.0042 ** 
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.565 on 244 degrees of freedom
#>   (1 observation deleted due to missingness)
#> Multiple R-squared:  0.265,  Adjusted R-squared:  0.256 
#> F-statistic: 29.3 on 3 and 244 DF,  p-value: 3.2e-16
```


:::
:::


There is also the R package `ecm`, but it uses a modified formulation of the model, see details for the function `ecm::ecm()`.
:::

In the example above, the time series were simulated as cointegrated. 
Below is an example of another I(1) process $W_t$ but with a stochastic trend different from that of $X_t$. 
In this case, the linear combination of individually integrated $W_t$ and $X_t$ does not produce a stationary time series, thus, $W_t$ and $X_t$ are not cointegrated.


::: {.cell}

```{.r .cell-code  code-fold="false"}
U2 <- lm(Wt ~ Xt)$residuals
tseries::adf.test(U2)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#>  Augmented Dickey-Fuller Test
#> 
#> data:  U2
#> Dickey-Fuller = -2, Lag order = 6, p-value = 0.7
#> alternative hypothesis: stationary
```


:::
:::



### Johansen test

The Johansen test allows for more than one cointegrating relationship. 
The null hypothesis for the trace test is that the number of cointegration vectors is $r<k$, vs. the alternative that $r=k$. 
The testing proceeds sequentially for $k=1,2,\dots$; and the first non-rejection of the null hypothesis is taken as an estimate of $r$.

Using the R package `urca`:

::: {.cell}

```{.r .cell-code  code-fold="false"}
library(urca)
vecm <- ca.jo(cbind(Yt, Xt, Wt))
summary(vecm)
```

::: {.cell-output .cell-output-stdout}

```
#> 
#> ###################### 
#> # Johansen-Procedure # 
#> ###################### 
#> 
#> Test type: maximal eigenvalue statistic (lambda max) , with linear trend 
#> 
#> Eigenvalues (lambda):
#> [1] 0.270915 0.025774 0.000838
#> 
#> Values of teststatistic and critical values of test:
#> 
#>           test 10pct  5pct 1pct
#> r <= 2 |  0.21   6.5  8.18 11.7
#> r <= 1 |  6.48  12.9 14.90 19.2
#> r = 0  | 78.36  18.9 21.07 25.8
#> 
#> Eigenvectors, normalised to first column:
#> (These are the cointegration relations)
#> 
#>          Yt.l2  Xt.l2 Wt.l2
#> Yt.l2  1.00000  1.000   1.0
#> Xt.l2 -0.49209 -5.234 -26.2
#> Wt.l2 -0.00497  0.383 -19.3
#> 
#> Weights W:
#> (This is the loading matrix)
#> 
#>       Yt.l2   Xt.l2     Wt.l2
#> Yt.d -0.686 0.00228  2.64e-06
#> Xt.d -0.179 0.00796 -1.54e-05
#> Wt.d  0.180 0.00253  1.59e-04
```


:::
:::


If two time series are cointegrated, then the usual regression in @eq-longr is the so-called long-run equilibrium relation or attractor, i.e., the relationship between $X_t$ and $Y_t$ can be explained by @eq-longr in a long run. 
@eq-longr is applied for estimation, not for testing [see Figure 6.1 in @Kirchgassner:Wolters:2007 on highly dispersed $t$-statistic]. 
The error correction model in @eq-ecm should be estimated for testing [$p$-values from the ECM can be used for testing, also see Chapter 6 in @Kirchgassner:Wolters:2007].


## Conclusion

Now we can incorporate trend effects into our models, using the three considered approaches or by testing for cointegration and applying an error correction model. 
The next step would be to incorporate autocorrelation structure in the residuals (the simulated example considered here used independent normally distributed noise, so it was an artificial ideal case of no autocorrelation, whereas we usually encounter autocorrelations, e.g., see residual diagnostics in the examples in @sec-incorporateTime).
-->


</main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./blackbox-attacks.html" class="pagination-link" aria-label="White-box Evasion Attack">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">White-box Evasion Attack</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./defenses-advml.html" class="pagination-link" aria-label="Poisoning Attacks">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Poisoning Attacks</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/kundan-kumarr/StatSphere/edit/master/data-poisoning.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/kundan-kumarr/StatSphere/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>